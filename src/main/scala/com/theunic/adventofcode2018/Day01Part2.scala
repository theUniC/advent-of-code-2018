package com.theunic.adventofcode2018

import scala.annotation.tailrec

object Day01Part2 {
  def main(args: Array[String]): Unit = {

    val changeFreq = 
      "+19\n-15\n+6\n+6\n+17\n-18\n+7\n+14\n+12\n+13\n-16\n+13\n+8\n+6\n-12\n-3\n-5\n+12\n-15\n+2\n-16\n-11\n+19\n+3\n-15\n+19\n-8\n+14\n-1\n-16\n-14\n+15\n+19\n+10\n-22\n-17\n+8\n-6\n-15\n-9\n-6\n-17\n-18\n-1\n+17\n+18\n-17\n+5\n-12\n+17\n-8\n+11\n-19\n-16\n+12\n+8\n-12\n+6\n-15\n+19\n+1\n-10\n-17\n-16\n-17\n-19\n-13\n+19\n-11\n-4\n-10\n+5\n+6\n+5\n-13\n-7\n+13\n-21\n-18\n-16\n-5\n-11\n-12\n-15\n-19\n+8\n-13\n-14\n-8\n+4\n+20\n+19\n+19\n+18\n-16\n+4\n-17\n-19\n-3\n+13\n+14\n-15\n-16\n+8\n+11\n+1\n+22\n+15\n+16\n+9\n+17\n+13\n+10\n-14\n-4\n-11\n+18\n-2\n+8\n+15\n+17\n-3\n-5\n+16\n-2\n+3\n+4\n-9\n-14\n-9\n-16\n+20\n-7\n-2\n+18\n-3\n-7\n+4\n+19\n+13\n+14\n-11\n-18\n-2\n-8\n+1\n+16\n+17\n+9\n-14\n+7\n+2\n+9\n-12\n+5\n-10\n+16\n-31\n-21\n+13\n-1\n+16\n-2\n+21\n-8\n+23\n-4\n+3\n+3\n+4\n+13\n+6\n-11\n+18\n+2\n-11\n-1\n-4\n+2\n+16\n+20\n-3\n+8\n-6\n+13\n-4\n-16\n-15\n+12\n+9\n-4\n-12\n-21\n+23\n-10\n+41\n+10\n+27\n-3\n+16\n+3\n-4\n-2\n+16\n-9\n+8\n-5\n-18\n+2\n+7\n-19\n+7\n-15\n+11\n+19\n+5\n-1\n-9\n+15\n+4\n+10\n-4\n+18\n+5\n+19\n-8\n-13\n-13\n+2\n+3\n-18\n+10\n+10\n-14\n+13\n-11\n+16\n+18\n-1\n+18\n-1\n+3\n-12\n+17\n-12\n+2\n-4\n-14\n+2\n+11\n+18\n+15\n-7\n+15\n+18\n+4\n+1\n-12\n-7\n-17\n-5\n+1\n+3\n+4\n-19\n+5\n+5\n-11\n-5\n+14\n+17\n+11\n+14\n-13\n+8\n-15\n+13\n+13\n+17\n+13\n+16\n-1\n-14\n+19\n+16\n-19\n-14\n+19\n+16\n+10\n-3\n+16\n+14\n+10\n+16\n+5\n+12\n-1\n+3\n-5\n+7\n+7\n+18\n+10\n-18\n+16\n-3\n-7\n-19\n+10\n-3\n-9\n-11\n+12\n-9\n-6\n-6\n-2\n-5\n-14\n-11\n-10\n+3\n-6\n-16\n-2\n-11\n+7\n-14\n-16\n+6\n+1\n+18\n-11\n+3\n+18\n+21\n+11\n-1\n+17\n+4\n+18\n-4\n+13\n-18\n-3\n+19\n-20\n-11\n-10\n-14\n-11\n-2\n-16\n-16\n-17\n+3\n+6\n-5\n+3\n-13\n-18\n+1\n+14\n-12\n+7\n-2\n+18\n-7\n-8\n-4\n-13\n+2\n+6\n-11\n+8\n-15\n+13\n+23\n-7\n+17\n+10\n-23\n+15\n-18\n+2\n-4\n-14\n-18\n-20\n+4\n-8\n+14\n-3\n-9\n-9\n+4\n+24\n-9\n-5\n+19\n+3\n+20\n-12\n+11\n+17\n+29\n-2\n-14\n+22\n+6\n-9\n+8\n+16\n+24\n+16\n-11\n-2\n-2\n-3\n+14\n+5\n+42\n-3\n-24\n+23\n-7\n+1\n+14\n-11\n+13\n-4\n-3\n+16\n-3\n+28\n+8\n+11\n+16\n+5\n+2\n+16\n+9\n-19\n-9\n-7\n-29\n-8\n-27\n-5\n+51\n+29\n+44\n+11\n+13\n+2\n+54\n+16\n-2\n-19\n+7\n+7\n+11\n-21\n-14\n+50\n+19\n+4\n-9\n-4\n+19\n+5\n-13\n-12\n-8\n+4\n-22\n-12\n+28\n+12\n-18\n-25\n+18\n-27\n+13\n+4\n+32\n+20\n+8\n+14\n-12\n+1\n+5\n+11\n-15\n-16\n+18\n+1\n-6\n+14\n-19\n+9\n-23\n-34\n+78\n+15\n-17\n+19\n+14\n+16\n+14\n-18\n+3\n-20\n+24\n+17\n+11\n-16\n+78\n+10\n-29\n+17\n+124\n-17\n+146\n-55\n-17\n+222\n-15\n+19\n+25\n-24\n-15\n-4\n+21\n+73857\n+6\n+15\n+3\n+16\n-14\n+18\n+5\n-6\n-5\n+8\n-17\n-15\n+18\n-9\n+10\n-8\n-10\n-16\n+9\n-1\n-2\n-15\n-11\n-13\n-16\n-5\n+15\n+4\n+14\n-5\n+8\n+7\n-18\n-3\n+2\n+8\n+5\n+5\n+14\n+18\n-17\n+16\n-5\n-18\n+8\n+7\n+20\n+4\n+11\n+6\n-4\n-8\n-2\n-1\n+14\n+4\n+5\n-6\n-5\n+16\n-3\n+19\n+13\n-12\n+5\n+1\n+18\n+2\n+5\n-13\n-1\n-1\n+4\n+1\n+4\n+17\n+14\n+3\n-14\n-13\n-18\n-3\n+11\n+18\n+10\n-15\n+4\n+15\n+16\n+8\n-14\n+5\n+18\n+12\n+18\n-9\n-6\n+12\n-1\n+7\n+8\n+12\n+15\n+11\n-16\n+15\n+18\n-6\n-2\n-3\n+10\n+10\n+13\n-12\n+9\n-3\n-13\n+20\n-12\n+19\n+6\n+3\n+18\n-15\n+13\n+5\n-17\n+15\n-8\n+17\n-18\n-11\n+15\n+12\n-9\n-16\n+11\n+10\n-13\n-3\n-8\n-12\n-18\n-17\n-20\n-2\n-10\n+15\n-7\n+9\n+4\n+14\n+11\n-2\n-11\n+5\n-8\n-19\n-4\n-2\n-9\n-15\n+8\n-5\n+7\n+13\n-11\n+8\n-11\n-20\n-10\n+11\n-21\n+16\n-2\n-17\n-15\n+9\n+16\n+8\n+3\n+6\n-15\n+21\n+15\n+7\n-17\n+35\n+9\n+14\n+19\n-3\n+4\n-8\n+11\n+17\n+13\n+14\n+4\n-9\n+1\n-17\n-1\n-13\n-19\n-19\n+13\n+24\n-17\n-17\n+20\n-12\n-20\n-2\n-4\n-19\n-5\n+20\n+1\n+8\n-4\n-17\n+10\n+23\n+37\n+10\n+8\n+23\n+3\n+14\n-7\n+19\n-17\n-18\n+8\n+6\n+20\n-3\n+2\n-6\n-17\n+9\n-8\n+17\n-7\n+11\n-8\n-9\n+15\n-4\n-9\n+8\n+18\n+12\n-9\n+13\n-15\n+17\n+16\n-12\n-2\n-14\n-4\n+19\n-16\n+3\n+19\n+19\n-17\n+9\n+4\n+14\n-15\n-18\n-4\n-8\n-14\n-18\n+20\n-13\n-17\n-19\n+4\n+5\n+11\n-9\n-14\n+15\n+31\n+11\n+11\n-20\n+1\n+14\n+4\n+11\n+3\n+17\n-14\n+9\n+13\n+16\n+6\n+5\n-6\n+13\n+3\n+4\n+13\n+10\n+14\n+4\n-1\n-16\n-14\n-6\n+2\n+8\n-5\n+3\n+17\n-4\n-5\n+14\n-12\n+5\n+1\n+14\n+20\n-5\n-5\n+18\n-19\n+9\n-11\n+1\n-12\n+17\n+9\n-6\n+5\n+25\n-13\n+7\n-4\n+8\n-3\n-24\n-40\n-16\n-5\n+10\n-6\n-18\n-14\n+17\n+10\n+18\n+16\n-14\n-18\n-11\n-15\n-13\n+11\n+6\n+8\n-18\n+5\n-8\n+4\n-13\n+19\n+15\n+12\n+6\n-16\n+4\n-5\n-7\n-7\n+6\n-3\n-18\n+17\n-29\n+7\n+7\n+3\n-13\n+1\n+15\n-12\n-14\n+22\n-7\n-17\n-3\n-19\n-15\n+9\n+19\n-9\n+19\n-6\n+14\n-5\n-6\n-39\n+30\n-15\n-51\n-44\n+1\n-22\n+26\n-60\n-25\n-10\n+19\n-22\n+11\n-9\n-29\n+5\n+9\n+7\n-14\n-17\n+4\n+3\n+4\n+3\n-19\n-8\n-18\n+13\n-18\n+3\n-8\n+9\n-13\n-5\n-28\n-9\n+5\n-9\n-3\n-4\n+1\n-3\n+19\n-4\n-7\n+2\n+2\n+11\n+17\n+14\n-18\n-22\n-16\n-16\n-1\n-10\n-4\n+1\n-17\n+24\n+17\n+24\n+1\n-6\n-15\n+28\n+7\n-6\n-18\n-12\n+33\n+34\n+3\n+11\n+5\n+15\n+2\n+4\n-14\n-10\n+19\n+8\n+20\n-74755"
        .split('\n')
        .to[List]
        .map(_.toLong)
    
    val freqs = Stream
                  .continually(changeFreq.toStream)
                  .flatten
                  .scan(0.toLong)(_ + _)
    
    println(findFirstRepeatedFreq(freqs).get)
  }
  
  def findFirstRepeatedFreq(stream: Stream[Long]): Option[Long] = {
    @tailrec
    def find(xs: Stream[Long], s: Set[Long]): Option[Long] = xs match {
      case x #:: _ if s(x)    => Some(x)
      case x #:: ys           => find(ys, s + x)
      case _                  => None
    }
    
    find(stream, Set[Long]())
  }
}
